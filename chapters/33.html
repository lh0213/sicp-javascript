<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SicpTextbookRails</title>
    <meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="9jnLJVWGb9tyUl+0ArgaCubj2EDbSrsaCj4j6TB94EtiuLmvOIQJopanUns9rPm2vlUHDIddOqJa/rX41EebNg==" />

    <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    -->
    <link href="https://fonts.googleapis.com/css?family=Droid+Sans|Droid+Sans+Mono|Droid+Serif" rel="stylesheet">
    <link rel="stylesheet" media="all" href="../assets/application-4afa0dc75ea8a2ff925eb41df709aa5f5fae6640df639d9b6ae50ed06be5a5d2.css" />

    <link rel="shortcut icon" type="image/x-icon" href="../assets/favicon-5cc7f923fb946d60fe9552847f4b6edd0f8cf2f122d6f3fef39d59ce84d47942.ico" />

    <script src="https://code.jquery.com/jquery-3.2.1.min.js"
			  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
	          crossorigin="anonymous">
    </script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>

    <script src="../assets/application-e1d34c17f2d1680f21b650089aea08e3ecfe292f1157f2d23bfa7d4d9d530c8b.js"></script>

    <!-- Rendering inline LaTeX -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          processEscapes: true,
          jax: ["input/TeX","output/HTML-CSS"]
        }
      });
    </script>
    <!--<script src="/mathjax/MathJax.js?config=TeX-AMS_HTML-full.js" type="text/javascript"></script>-->
    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js" type="text/javascript"></script>
    <![endif]-->
  </head>
  <body>

     <nav class="navbar navbar-toggleable-md navbar-inverse bg-inverse fixed-top">
      <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#nav-sidebar" aria-controls="nav-sidebar" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
       <a class="navbar-brand navbar-brand-short" href="../chapters.html">CS1101S: SICP</a>
       <a class="navbar-brand navbar-brand-long" href="../chapters.html">CS1101S: Structure and Interpretation
          of Computer Programs</a>

       <div class="collapse navbar-collapse" id="navbarsExampleDefault">
         <form id="search" class="form-inline my-2 my-lg-0">
           <input id="search-box" class="form-control mr-sm-2" type="text" placeholder="Search">
           <div id="search-button" class="btn btn-outline-success my-2 my-sm-0">Search</div>

           <script>
               (function() {
                var cx = "002429487986305006822:ztnrbwx01qy";
                var gcse = document.createElement('script');
                gcse.type = 'text/javascript';
                gcse.async = true;
                gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(gcse, s);
               })();
            </script>
            <gcse:search></gcse:search>
         </form>
       </div>
     </nav>

     <div class="container scroll">

          <div class="collapse" id="nav-sidebar" role="tablist" aria-multiselectable="true">
                             <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-122">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#nav-sidebar" href="#sidebar-collapse-122" aria-expanded="false" aria-controls="sidebar-collapse-122">
                    <a href="122.html">About</a>
                  </a>
                </h5>
              </div>
            </div>

                             <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-123">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#nav-sidebar" href="#sidebar-collapse-123" aria-expanded="false" aria-controls="sidebar-collapse-123">
                    <a href="123.html">References</a>
                  </a>
                </h5>
              </div>
            </div>

                             <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-124">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#nav-sidebar" href="#sidebar-collapse-124" aria-expanded="false" aria-controls="sidebar-collapse-124">
                    <a href="124.html">Webpreface</a>
                  </a>
                </h5>
              </div>
            </div>

                             <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-1">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#nav-sidebar" href="#sidebar-collapse-1" aria-expanded="true" aria-controls="sidebar-collapse-1">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#nav-sidebar" href="#sidebar-collapse-1" aria-expanded="true" aria-controls="sidebar-collapse-1">
                    -
                  </a>
                    <a href="1.html">1.       Building Abstractions with       Functions    </a>
                </h5>
              </div>
              <div id="sidebar-collapse-1" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-2">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#sidebar-1" href="#sidebar-collapse-2" aria-expanded="true" aria-controls="sidebar-collapse-2">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#sidebar-1" href="#sidebar-collapse-2" aria-expanded="true" aria-controls="sidebar-collapse-2">
                    -
                  </a>
                    <a href="2.html">1. The Elements of Programming</a>
                </h5>
              </div>
              <div id="sidebar-collapse-2" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-3">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-2" href="#sidebar-collapse-3" aria-expanded="false" aria-controls="sidebar-collapse-3">
                    <a href="3.html">1. Expressions</a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-4">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-2" href="#sidebar-collapse-4" aria-expanded="false" aria-controls="sidebar-collapse-4">
                    <a href="4.html">2. Naming and the Environment</a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-5">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-2" href="#sidebar-collapse-5" aria-expanded="false" aria-controls="sidebar-collapse-5">
                    <a href="5.html">3.           Evaluating          Operator Combinations                  </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-6">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-2" href="#sidebar-collapse-6" aria-expanded="false" aria-controls="sidebar-collapse-6">
                    <a href="6.html">4.           Functions        </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-7">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-2" href="#sidebar-collapse-7" aria-expanded="false" aria-controls="sidebar-collapse-7">
                    <a href="7.html">5.           The Substitution Model for                                                 Function                              Application        </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-8">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-2" href="#sidebar-collapse-8" aria-expanded="false" aria-controls="sidebar-collapse-8">
                    <a href="8.html">6.           Conditional                                           Statements                              and Predicates        </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-9">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-2" href="#sidebar-collapse-9" aria-expanded="false" aria-controls="sidebar-collapse-9">
                    <a href="9.html">7. Example: Square Roots by Newtons Method</a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-10">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-2" href="#sidebar-collapse-10" aria-expanded="false" aria-controls="sidebar-collapse-10">
                    <a href="10.html">8.                                                 Functions                                as Black-Box Abstractions        </a>
                  </a>
                </h5>
              </div>
            </div>

                </div>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-11">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#sidebar-1" href="#sidebar-collapse-11" aria-expanded="true" aria-controls="sidebar-collapse-11">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#sidebar-1" href="#sidebar-collapse-11" aria-expanded="true" aria-controls="sidebar-collapse-11">
                    -
                  </a>
                    <a href="11.html">2.             Functions            and the Processes They Generate      </a>
                </h5>
              </div>
              <div id="sidebar-collapse-11" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-12">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-11" href="#sidebar-collapse-12" aria-expanded="false" aria-controls="sidebar-collapse-12">
                    <a href="12.html">1. Linear Recursion and Iteration</a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-13">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-11" href="#sidebar-collapse-13" aria-expanded="false" aria-controls="sidebar-collapse-13">
                    <a href="13.html">2. Tree Recursion</a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-14">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-11" href="#sidebar-collapse-14" aria-expanded="false" aria-controls="sidebar-collapse-14">
                    <a href="14.html">3. Orders of Growth</a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-15">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-11" href="#sidebar-collapse-15" aria-expanded="false" aria-controls="sidebar-collapse-15">
                    <a href="15.html">4. Exponentiation</a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-16">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-11" href="#sidebar-collapse-16" aria-expanded="false" aria-controls="sidebar-collapse-16">
                    <a href="16.html">5. Greatest Common Divisors</a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-17">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-11" href="#sidebar-collapse-17" aria-expanded="false" aria-controls="sidebar-collapse-17">
                    <a href="17.html">6. Example: Testing for Primality</a>
                  </a>
                </h5>
              </div>
            </div>

                </div>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-18">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#sidebar-1" href="#sidebar-collapse-18" aria-expanded="true" aria-controls="sidebar-collapse-18">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#sidebar-1" href="#sidebar-collapse-18" aria-expanded="true" aria-controls="sidebar-collapse-18">
                    -
                  </a>
                    <a href="18.html">3.         Formulating Abstractions with Higher-Order         Functions      </a>
                </h5>
              </div>
              <div id="sidebar-collapse-18" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-19">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-18" href="#sidebar-collapse-19" aria-expanded="false" aria-controls="sidebar-collapse-19">
                    <a href="19.html">1.           Functions          as Arguments        </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-20">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-18" href="#sidebar-collapse-20" aria-expanded="false" aria-controls="sidebar-collapse-20">
                    <a href="20.html">2.           Function Definition Expressions          </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-21">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-18" href="#sidebar-collapse-21" aria-expanded="false" aria-controls="sidebar-collapse-21">
                    <a href="21.html">3.             Functions            as General Methods          </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-22">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-18" href="#sidebar-collapse-22" aria-expanded="false" aria-controls="sidebar-collapse-22">
                    <a href="22.html">4.               Functions              as Returned Values            </a>
                  </a>
                </h5>
              </div>
            </div>

                </div>
              </div>
            </div>

                </div>
              </div>
            </div>

                             <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-23">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#nav-sidebar" href="#sidebar-collapse-23" aria-expanded="true" aria-controls="sidebar-collapse-23">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#nav-sidebar" href="#sidebar-collapse-23" aria-expanded="true" aria-controls="sidebar-collapse-23">
                    -
                  </a>
                    <a href="23.html">2. Building Abstractions with Data</a>
                </h5>
              </div>
              <div id="sidebar-collapse-23" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-24">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#sidebar-23" href="#sidebar-collapse-24" aria-expanded="true" aria-controls="sidebar-collapse-24">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#sidebar-23" href="#sidebar-collapse-24" aria-expanded="true" aria-controls="sidebar-collapse-24">
                    -
                  </a>
                    <a href="24.html">1. Introduction to Data Abstraction</a>
                </h5>
              </div>
              <div id="sidebar-collapse-24" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-25">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-24" href="#sidebar-collapse-25" aria-expanded="false" aria-controls="sidebar-collapse-25">
                    <a href="25.html">1.         Example: Arithmetic Operations for Rational Numbers      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-26">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-24" href="#sidebar-collapse-26" aria-expanded="false" aria-controls="sidebar-collapse-26">
                    <a href="26.html">2.         Abstraction Barriers      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-27">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-24" href="#sidebar-collapse-27" aria-expanded="false" aria-controls="sidebar-collapse-27">
                    <a href="27.html">3.         What Is Meant by Data?      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-28">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-24" href="#sidebar-collapse-28" aria-expanded="false" aria-controls="sidebar-collapse-28">
                    <a href="28.html">4.         Extended Exercise: Interval Arithmetic      </a>
                  </a>
                </h5>
              </div>
            </div>

                </div>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-29">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#sidebar-23" href="#sidebar-collapse-29" aria-expanded="true" aria-controls="sidebar-collapse-29">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#sidebar-23" href="#sidebar-collapse-29" aria-expanded="true" aria-controls="sidebar-collapse-29">
                    -
                  </a>
                    <a href="29.html">2. Hierarchical Data and the Closure Property</a>
                </h5>
              </div>
              <div id="sidebar-collapse-29" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-30">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-29" href="#sidebar-collapse-30" aria-expanded="false" aria-controls="sidebar-collapse-30">
                    <a href="30.html">1.         Representing Sequences      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-31">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-29" href="#sidebar-collapse-31" aria-expanded="false" aria-controls="sidebar-collapse-31">
                    <a href="31.html">2.         Hierarchical Structures      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-32">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-29" href="#sidebar-collapse-32" aria-expanded="false" aria-controls="sidebar-collapse-32">
                    <a href="32.html">3.         Sequences as Conventional Interfaces      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-33">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-29" href="#sidebar-collapse-33" aria-expanded="false" aria-controls="sidebar-collapse-33">
                    <a href="33.html">4.         Example: A Picture Language      </a>
                  </a>
                </h5>
              </div>
            </div>

                </div>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-34">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#sidebar-23" href="#sidebar-collapse-34" aria-expanded="true" aria-controls="sidebar-collapse-34">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#sidebar-23" href="#sidebar-collapse-34" aria-expanded="true" aria-controls="sidebar-collapse-34">
                    -
                  </a>
                    <a href="34.html">3. Symbolic Data</a>
                </h5>
              </div>
              <div id="sidebar-collapse-34" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-35">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-34" href="#sidebar-collapse-35" aria-expanded="false" aria-controls="sidebar-collapse-35">
                    <a href="35.html">1.         Strings      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-36">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-34" href="#sidebar-collapse-36" aria-expanded="false" aria-controls="sidebar-collapse-36">
                    <a href="36.html">2.         Example: Symbolic Differentiation      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-37">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-34" href="#sidebar-collapse-37" aria-expanded="false" aria-controls="sidebar-collapse-37">
                    <a href="37.html">3.         Example: Representing Sets      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-38">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-34" href="#sidebar-collapse-38" aria-expanded="false" aria-controls="sidebar-collapse-38">
                    <a href="38.html">4.         Example: Huffman Encoding Trees      </a>
                  </a>
                </h5>
              </div>
            </div>

                </div>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-39">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#sidebar-23" href="#sidebar-collapse-39" aria-expanded="true" aria-controls="sidebar-collapse-39">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#sidebar-23" href="#sidebar-collapse-39" aria-expanded="true" aria-controls="sidebar-collapse-39">
                    -
                  </a>
                    <a href="39.html">4. Multiple Representations for Abstract Data</a>
                </h5>
              </div>
              <div id="sidebar-collapse-39" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-40">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-39" href="#sidebar-collapse-40" aria-expanded="false" aria-controls="sidebar-collapse-40">
                    <a href="40.html">1.         Representations for Complex Numbers      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-41">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-39" href="#sidebar-collapse-41" aria-expanded="false" aria-controls="sidebar-collapse-41">
                    <a href="41.html">2.         Tagged data      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-42">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-39" href="#sidebar-collapse-42" aria-expanded="false" aria-controls="sidebar-collapse-42">
                    <a href="42.html">3.         Data-Directed Programming and Additivity      </a>
                  </a>
                </h5>
              </div>
            </div>

                </div>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-43">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#sidebar-23" href="#sidebar-collapse-43" aria-expanded="true" aria-controls="sidebar-collapse-43">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#sidebar-23" href="#sidebar-collapse-43" aria-expanded="true" aria-controls="sidebar-collapse-43">
                    -
                  </a>
                    <a href="43.html">5. Systems with Generic Operations</a>
                </h5>
              </div>
              <div id="sidebar-collapse-43" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-44">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-43" href="#sidebar-collapse-44" aria-expanded="false" aria-controls="sidebar-collapse-44">
                    <a href="44.html">1.         Generic Arithmetic Operations      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-45">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-43" href="#sidebar-collapse-45" aria-expanded="false" aria-controls="sidebar-collapse-45">
                    <a href="45.html">2.         Combining Data of Different Types      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-46">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-43" href="#sidebar-collapse-46" aria-expanded="false" aria-controls="sidebar-collapse-46">
                    <a href="46.html">3.         Example: Symbolic Algebra      </a>
                  </a>
                </h5>
              </div>
            </div>

                </div>
              </div>
            </div>

                </div>
              </div>
            </div>

                             <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-47">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#nav-sidebar" href="#sidebar-collapse-47" aria-expanded="true" aria-controls="sidebar-collapse-47">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#nav-sidebar" href="#sidebar-collapse-47" aria-expanded="true" aria-controls="sidebar-collapse-47">
                    -
                  </a>
                    <a href="47.html">3. Modularity, Objects, and State</a>
                </h5>
              </div>
              <div id="sidebar-collapse-47" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-48">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#sidebar-47" href="#sidebar-collapse-48" aria-expanded="true" aria-controls="sidebar-collapse-48">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#sidebar-47" href="#sidebar-collapse-48" aria-expanded="true" aria-controls="sidebar-collapse-48">
                    -
                  </a>
                    <a href="48.html">1. Assignment and Local State</a>
                </h5>
              </div>
              <div id="sidebar-collapse-48" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-49">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-48" href="#sidebar-collapse-49" aria-expanded="false" aria-controls="sidebar-collapse-49">
                    <a href="49.html">1.         Local State Variables      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-50">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-48" href="#sidebar-collapse-50" aria-expanded="false" aria-controls="sidebar-collapse-50">
                    <a href="50.html">2.         The Benefits of Introducing Assignment      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-51">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-48" href="#sidebar-collapse-51" aria-expanded="false" aria-controls="sidebar-collapse-51">
                    <a href="51.html">3.         The Costs of Introducing Assignment      </a>
                  </a>
                </h5>
              </div>
            </div>

                </div>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-52">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#sidebar-47" href="#sidebar-collapse-52" aria-expanded="true" aria-controls="sidebar-collapse-52">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#sidebar-47" href="#sidebar-collapse-52" aria-expanded="true" aria-controls="sidebar-collapse-52">
                    -
                  </a>
                    <a href="52.html">2. The Environment Model of Evaluation</a>
                </h5>
              </div>
              <div id="sidebar-collapse-52" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-53">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-52" href="#sidebar-collapse-53" aria-expanded="false" aria-controls="sidebar-collapse-53">
                    <a href="53.html">1.         The Rules for Evaluation      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-54">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-52" href="#sidebar-collapse-54" aria-expanded="false" aria-controls="sidebar-collapse-54">
                    <a href="54.html">2.         Applying Simple        Functions      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-55">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-52" href="#sidebar-collapse-55" aria-expanded="false" aria-controls="sidebar-collapse-55">
                    <a href="55.html">3.         Frames as the Repository of Local State      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-56">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-52" href="#sidebar-collapse-56" aria-expanded="false" aria-controls="sidebar-collapse-56">
                    <a href="56.html">4.         Internal Definitions      </a>
                  </a>
                </h5>
              </div>
            </div>

                </div>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-57">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#sidebar-47" href="#sidebar-collapse-57" aria-expanded="true" aria-controls="sidebar-collapse-57">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#sidebar-47" href="#sidebar-collapse-57" aria-expanded="true" aria-controls="sidebar-collapse-57">
                    -
                  </a>
                    <a href="57.html">3. Modeling with Mutable Data</a>
                </h5>
              </div>
              <div id="sidebar-collapse-57" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-58">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-57" href="#sidebar-collapse-58" aria-expanded="false" aria-controls="sidebar-collapse-58">
                    <a href="58.html">1.         Mutable List Structure      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-59">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-57" href="#sidebar-collapse-59" aria-expanded="false" aria-controls="sidebar-collapse-59">
                    <a href="59.html">2.         Representing Queues      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-60">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-57" href="#sidebar-collapse-60" aria-expanded="false" aria-controls="sidebar-collapse-60">
                    <a href="60.html">3.         Representing Tables      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-61">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-57" href="#sidebar-collapse-61" aria-expanded="false" aria-controls="sidebar-collapse-61">
                    <a href="61.html">4.         A Simulator for Digital Circuits      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-62">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-57" href="#sidebar-collapse-62" aria-expanded="false" aria-controls="sidebar-collapse-62">
                    <a href="62.html">5.         Propagation of Constraints      </a>
                  </a>
                </h5>
              </div>
            </div>

                </div>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-63">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#sidebar-47" href="#sidebar-collapse-63" aria-expanded="true" aria-controls="sidebar-collapse-63">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#sidebar-47" href="#sidebar-collapse-63" aria-expanded="true" aria-controls="sidebar-collapse-63">
                    -
                  </a>
                    <a href="63.html">4. Concurrency: Time Is of the Essence</a>
                </h5>
              </div>
              <div id="sidebar-collapse-63" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-64">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-63" href="#sidebar-collapse-64" aria-expanded="false" aria-controls="sidebar-collapse-64">
                    <a href="64.html">1.         The Nature of Time in Concurrent Systems      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-65">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-63" href="#sidebar-collapse-65" aria-expanded="false" aria-controls="sidebar-collapse-65">
                    <a href="65.html">2.         Mechanisms for Controlling Concurrency      </a>
                  </a>
                </h5>
              </div>
            </div>

                </div>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-66">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#sidebar-47" href="#sidebar-collapse-66" aria-expanded="true" aria-controls="sidebar-collapse-66">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#sidebar-47" href="#sidebar-collapse-66" aria-expanded="true" aria-controls="sidebar-collapse-66">
                    -
                  </a>
                    <a href="66.html">5. Streams</a>
                </h5>
              </div>
              <div id="sidebar-collapse-66" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-67">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-66" href="#sidebar-collapse-67" aria-expanded="false" aria-controls="sidebar-collapse-67">
                    <a href="67.html">1.         Streams Are Delayed Lists      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-68">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-66" href="#sidebar-collapse-68" aria-expanded="false" aria-controls="sidebar-collapse-68">
                    <a href="68.html">2.         Infinite Streams      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-69">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-66" href="#sidebar-collapse-69" aria-expanded="false" aria-controls="sidebar-collapse-69">
                    <a href="69.html">3.   Exploiting the Stream Paradigm      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-70">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-66" href="#sidebar-collapse-70" aria-expanded="false" aria-controls="sidebar-collapse-70">
                    <a href="70.html">4.   Streams and Delayed Evaluation      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-71">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-66" href="#sidebar-collapse-71" aria-expanded="false" aria-controls="sidebar-collapse-71">
                    <a href="71.html">5.   Modularity of Functional Programs and Modularity of Objects      </a>
                  </a>
                </h5>
              </div>
            </div>

                </div>
              </div>
            </div>

                </div>
              </div>
            </div>

                             <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-72">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#nav-sidebar" href="#sidebar-collapse-72" aria-expanded="true" aria-controls="sidebar-collapse-72">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#nav-sidebar" href="#sidebar-collapse-72" aria-expanded="true" aria-controls="sidebar-collapse-72">
                    -
                  </a>
                    <a href="72.html">4. Metalinguistic Abstraction</a>
                </h5>
              </div>
              <div id="sidebar-collapse-72" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-73">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#sidebar-72" href="#sidebar-collapse-73" aria-expanded="true" aria-controls="sidebar-collapse-73">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#sidebar-72" href="#sidebar-collapse-73" aria-expanded="true" aria-controls="sidebar-collapse-73">
                    -
                  </a>
                    <a href="73.html">1. The Metacircular Evaluator</a>
                </h5>
              </div>
              <div id="sidebar-collapse-73" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-74">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-73" href="#sidebar-collapse-74" aria-expanded="false" aria-controls="sidebar-collapse-74">
                    <a href="74.html">1.   The Core of the Evaluator      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-75">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-73" href="#sidebar-collapse-75" aria-expanded="false" aria-controls="sidebar-collapse-75">
                    <a href="75.html">2.   Representing Statements and Expressions      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-76">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-73" href="#sidebar-collapse-76" aria-expanded="false" aria-controls="sidebar-collapse-76">
                    <a href="76.html">3.   Evaluator Data Structures      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-77">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-73" href="#sidebar-collapse-77" aria-expanded="false" aria-controls="sidebar-collapse-77">
                    <a href="77.html">4.   Running the Evaluator as a Program      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-78">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-73" href="#sidebar-collapse-78" aria-expanded="false" aria-controls="sidebar-collapse-78">
                    <a href="78.html">5.   Data as Programs      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-79">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-73" href="#sidebar-collapse-79" aria-expanded="false" aria-controls="sidebar-collapse-79">
                    <a href="79.html">6.   Internal Definitions      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-80">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-73" href="#sidebar-collapse-80" aria-expanded="false" aria-controls="sidebar-collapse-80">
                    <a href="80.html">7.   Separating Syntactic Analysis from Execution      </a>
                  </a>
                </h5>
              </div>
            </div>

                </div>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-81">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#sidebar-72" href="#sidebar-collapse-81" aria-expanded="true" aria-controls="sidebar-collapse-81">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#sidebar-72" href="#sidebar-collapse-81" aria-expanded="true" aria-controls="sidebar-collapse-81">
                    -
                  </a>
                    <a href="81.html">2. Variations on a SchemeLazy Evaluation</a>
                </h5>
              </div>
              <div id="sidebar-collapse-81" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-82">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-81" href="#sidebar-collapse-82" aria-expanded="false" aria-controls="sidebar-collapse-82">
                    <a href="82.html">1.   Normal Order and Applicative Order      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-83">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-81" href="#sidebar-collapse-83" aria-expanded="false" aria-controls="sidebar-collapse-83">
                    <a href="83.html">2.   An Interpreter with Lazy Evaluation      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-84">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-81" href="#sidebar-collapse-84" aria-expanded="false" aria-controls="sidebar-collapse-84">
                    <a href="84.html">3.   Streams as Lazy Lists      </a>
                  </a>
                </h5>
              </div>
            </div>

                </div>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-85">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#sidebar-72" href="#sidebar-collapse-85" aria-expanded="true" aria-controls="sidebar-collapse-85">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#sidebar-72" href="#sidebar-collapse-85" aria-expanded="true" aria-controls="sidebar-collapse-85">
                    -
                  </a>
                    <a href="85.html">3. Variations on a SchemeNondeterministic Computing</a>
                </h5>
              </div>
              <div id="sidebar-collapse-85" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-86">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-85" href="#sidebar-collapse-86" aria-expanded="false" aria-controls="sidebar-collapse-86">
                    <a href="86.html">1.   Amb and Search      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-87">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-85" href="#sidebar-collapse-87" aria-expanded="false" aria-controls="sidebar-collapse-87">
                    <a href="87.html">2.   Examples of Nondeterministic Programs      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-88">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-85" href="#sidebar-collapse-88" aria-expanded="false" aria-controls="sidebar-collapse-88">
                    <a href="88.html">3.   Implementing the Amb Evaluator      </a>
                  </a>
                </h5>
              </div>
            </div>

                </div>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-89">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#sidebar-72" href="#sidebar-collapse-89" aria-expanded="true" aria-controls="sidebar-collapse-89">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#sidebar-72" href="#sidebar-collapse-89" aria-expanded="true" aria-controls="sidebar-collapse-89">
                    -
                  </a>
                    <a href="89.html">4. Logic Programming</a>
                </h5>
              </div>
              <div id="sidebar-collapse-89" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-90">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-89" href="#sidebar-collapse-90" aria-expanded="false" aria-controls="sidebar-collapse-90">
                    <a href="90.html">1.   Deductive Information Retrieval      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-91">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-89" href="#sidebar-collapse-91" aria-expanded="false" aria-controls="sidebar-collapse-91">
                    <a href="91.html">2.   How the Query System Works      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-92">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-89" href="#sidebar-collapse-92" aria-expanded="false" aria-controls="sidebar-collapse-92">
                    <a href="92.html">3.   Is Logic Programming Mathematical Logic?      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-93">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-89" href="#sidebar-collapse-93" aria-expanded="false" aria-controls="sidebar-collapse-93">
                    <a href="93.html">4.   Implementing the Query System      </a>
                  </a>
                </h5>
              </div>
            </div>

                </div>
              </div>
            </div>

                </div>
              </div>
            </div>

                             <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-94">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#nav-sidebar" href="#sidebar-collapse-94" aria-expanded="true" aria-controls="sidebar-collapse-94">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#nav-sidebar" href="#sidebar-collapse-94" aria-expanded="true" aria-controls="sidebar-collapse-94">
                    -
                  </a>
                    <a href="94.html">5. Computing with Register Machines</a>
                </h5>
              </div>
              <div id="sidebar-collapse-94" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-95">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#sidebar-94" href="#sidebar-collapse-95" aria-expanded="true" aria-controls="sidebar-collapse-95">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#sidebar-94" href="#sidebar-collapse-95" aria-expanded="true" aria-controls="sidebar-collapse-95">
                    -
                  </a>
                    <a href="95.html">1. Designing Register Machines</a>
                </h5>
              </div>
              <div id="sidebar-collapse-95" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-96">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-95" href="#sidebar-collapse-96" aria-expanded="false" aria-controls="sidebar-collapse-96">
                    <a href="96.html">1.   A Language for Describing Register Machines      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-97">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-95" href="#sidebar-collapse-97" aria-expanded="false" aria-controls="sidebar-collapse-97">
                    <a href="97.html">2.   Abstraction in Machine Design      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-98">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-95" href="#sidebar-collapse-98" aria-expanded="false" aria-controls="sidebar-collapse-98">
                    <a href="98.html">3.   Subroutines      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-99">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-95" href="#sidebar-collapse-99" aria-expanded="false" aria-controls="sidebar-collapse-99">
                    <a href="99.html">4.   Using a Stack to Implement Recursion      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-100">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-95" href="#sidebar-collapse-100" aria-expanded="false" aria-controls="sidebar-collapse-100">
                    <a href="100.html">5.   Instruction Summary      </a>
                  </a>
                </h5>
              </div>
            </div>

                </div>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-101">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#sidebar-94" href="#sidebar-collapse-101" aria-expanded="true" aria-controls="sidebar-collapse-101">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#sidebar-94" href="#sidebar-collapse-101" aria-expanded="true" aria-controls="sidebar-collapse-101">
                    -
                  </a>
                    <a href="101.html">2. A Register-Machine Simulator</a>
                </h5>
              </div>
              <div id="sidebar-collapse-101" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-102">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-101" href="#sidebar-collapse-102" aria-expanded="false" aria-controls="sidebar-collapse-102">
                    <a href="102.html">1.   The Machine Model      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-103">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-101" href="#sidebar-collapse-103" aria-expanded="false" aria-controls="sidebar-collapse-103">
                    <a href="103.html">2.   The Assembler      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-104">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-101" href="#sidebar-collapse-104" aria-expanded="false" aria-controls="sidebar-collapse-104">
                    <a href="104.html">3.   Generating Execution  Functions  for Instructions      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-105">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-101" href="#sidebar-collapse-105" aria-expanded="false" aria-controls="sidebar-collapse-105">
                    <a href="105.html">4.   Monitoring Machine Performance      </a>
                  </a>
                </h5>
              </div>
            </div>

                </div>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-106">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#sidebar-94" href="#sidebar-collapse-106" aria-expanded="true" aria-controls="sidebar-collapse-106">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#sidebar-94" href="#sidebar-collapse-106" aria-expanded="true" aria-controls="sidebar-collapse-106">
                    -
                  </a>
                    <a href="106.html">3. Storage Allocation and Garbage Collection</a>
                </h5>
              </div>
              <div id="sidebar-collapse-106" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-107">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-106" href="#sidebar-collapse-107" aria-expanded="false" aria-controls="sidebar-collapse-107">
                    <a href="107.html">1.   Memory as Vectors      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-108">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-106" href="#sidebar-collapse-108" aria-expanded="false" aria-controls="sidebar-collapse-108">
                    <a href="108.html">2.   Maintaining the Illusion of Infinite Memory      </a>
                  </a>
                </h5>
              </div>
            </div>

                </div>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-109">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#sidebar-94" href="#sidebar-collapse-109" aria-expanded="true" aria-controls="sidebar-collapse-109">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#sidebar-94" href="#sidebar-collapse-109" aria-expanded="true" aria-controls="sidebar-collapse-109">
                    -
                  </a>
                    <a href="109.html">4. The Explicit-Control Evaluator</a>
                </h5>
              </div>
              <div id="sidebar-collapse-109" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-110">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-109" href="#sidebar-collapse-110" aria-expanded="false" aria-controls="sidebar-collapse-110">
                    <a href="110.html">1.   The Core of the Explicit-Control Evaluator      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-111">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-109" href="#sidebar-collapse-111" aria-expanded="false" aria-controls="sidebar-collapse-111">
                    <a href="111.html">2.   Sequence Evaluation and Tail Recursion      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-112">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-109" href="#sidebar-collapse-112" aria-expanded="false" aria-controls="sidebar-collapse-112">
                    <a href="112.html">3.   Conditionals, Assignments, and Definitions      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-113">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-109" href="#sidebar-collapse-113" aria-expanded="false" aria-controls="sidebar-collapse-113">
                    <a href="113.html">4.   Running the Evaluator      </a>
                  </a>
                </h5>
              </div>
            </div>

                </div>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-114">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" data-parent="#sidebar-94" href="#sidebar-collapse-114" aria-expanded="true" aria-controls="sidebar-collapse-114">
                    +
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" data-parent="#sidebar-94" href="#sidebar-collapse-114" aria-expanded="true" aria-controls="sidebar-collapse-114">
                    -
                  </a>
                    <a href="114.html">5. Compilation</a>
                </h5>
              </div>
              <div id="sidebar-collapse-114" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
                                <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-115">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-114" href="#sidebar-collapse-115" aria-expanded="false" aria-controls="sidebar-collapse-115">
                    <a href="115.html">1.   Structure of the Compiler      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-116">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-114" href="#sidebar-collapse-116" aria-expanded="false" aria-controls="sidebar-collapse-116">
                    <a href="116.html">2.   Compiling Expressions      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-117">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-114" href="#sidebar-collapse-117" aria-expanded="false" aria-controls="sidebar-collapse-117">
                    <a href="117.html">3.   Compiling Combinations      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-118">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-114" href="#sidebar-collapse-118" aria-expanded="false" aria-controls="sidebar-collapse-118">
                    <a href="118.html">4.   Combining Instruction Sequences      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-119">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-114" href="#sidebar-collapse-119" aria-expanded="false" aria-controls="sidebar-collapse-119">
                    <a href="119.html">5.   An Example of Compiled Code      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-120">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-114" href="#sidebar-collapse-120" aria-expanded="false" aria-controls="sidebar-collapse-120">
                    <a href="120.html">6.   Lexical Addressing      </a>
                  </a>
                </h5>
              </div>
            </div>
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-121">
                <h5 class="mb-0">
                  <a class="collapsed" data-toggle="collapse" data-parent="#sidebar-114" href="#sidebar-collapse-121" aria-expanded="false" aria-controls="sidebar-collapse-121">
                    <a href="121.html">7.   Interfacing Compiled Code to the Evaluator      </a>
                  </a>
                </h5>
              </div>
            </div>

                </div>
              </div>
            </div>

                </div>
              </div>
            </div>

          </div>

           <div class="chapter-content">
    <div class="chapter-title">
        2.2.4.
        Example: A Picture Language
      
    </div>
    <div class="chapter-text" >
        <div class="SUBSECTION"><SUBSECTION>
      

      
      

      <p>
        This section presents a simple language for drawing
        pictures that illustrates the
        power of data abstraction and closure,
        and also exploits higher-order
        functions
        in
        an essential way.  The language
        is designed to make it easy to experiment with patterns
        such as the ones in Figure <REF NAME="fig:sqlimit-designs"></REF>, which are
        composed of repeated elements that are shifted and
        scaled.<a class="superscript" id="footnote-link-1" href="33.html#footnote-1">[1]</a> In this language,
        the data objects being combined
        are represented as
        functions
        rather than as list structure.
        Just as <kbd>pair</kbd>, which satisfies the
        
        closure property,
        allowed us to easily build arbitrarily complicated
        list structure, the operations in this language, which also
        satisfy the closure property, allow us to easily build
        arbitrarily complicated patterns.

              <FIGURE>
                <IMAGE src="img_original/ch2-Z-G-24.gif"></IMAGE>
                   
                <IMAGE src="img_original/ch2-Z-G-25.gif"></IMAGE>
                
                <div class="chapter-text-CAPTION">Designs generated with the picture language.
                </div>
              </FIGURE>
      </p>

      <h2>
        The picture language
      </h2>

      <p>
        When we began our study of programming in
        Section <REF NAME="sec:elements-of-programming"></REF>, we emphasized the
        importance of describing a language by focusing on the language's
        primitives, its means of combination, and its means of abstraction.
        We'll follow that framework here.
      </p>

      <p>
        Part of the elegance of this picture language is that there is
        only one kind of element, called a
        
        <EM>painter</EM>.  A painter
        draws an image that is shifted and scaled to fit within a designated
        
        parallelogram-shaped frame.  For example, there's a primitive painter
        we'll call <kbd>wave</kbd> that makes a crude line drawing, as
        shown in Figure <REF NAME="fig:wave"></REF>.

              <FIGURE>
                <IMAGE src="img_original/ch2-Z-G-26.gif"></IMAGE>
                   
                <IMAGE src="img_original/ch2-Z-G-27.gif"></IMAGE>

                <IMAGE src="img_original/ch2-Z-G-28.gif"></IMAGE>
                   
                <IMAGE src="img_original/ch2-Z-G-29.gif"></IMAGE>

                
                <div class="chapter-text-CAPTION">Images produced by the <kbd>wave</kbd> painter, with respect
        to four different frames.  The frames, shown with dotted lines, are not
        part of the images.
                </div>
              </FIGURE>

        The actual shape of the drawing depends on the frameall
        four images in Figure <REF NAME="fig:wave"></REF> are produced by the same <kbd>wave</kbd> painter, but with respect to four different frames.
        <SPLIT>
          
            All our painters will draw in a square-shaped viewing area of size 400x400
            pixels. We will handle the definition of frames in more detail below. For
            now, let us assume that we have a particular frame,
            called <kbd>full_frame</kbd>,
            which refers to the the entire viewing area. Now we can apply our painter
            <kbd>wave</kbd> to
            <kbd>full_frame</kbd>, as follows.

            

            

            <div class="snippet" id="javascript_33_0_div"></div>
<div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('wave(full_frame);','javascript_33_0','svg()', event,1.0);window.eval('function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);');">wave(full_frame);</pre>
<a href="http://source-ide-new.surge.sh/?snippet=wave(full_frame);&amp;hidden=function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>
          
        </SPLIT>

        Painters can be more elaborate than this:
        The primitive
        painter called <kbd>rogers</kbd> paints a picture of MIT's founder,
        William Barton Rogers, as shown in Figure <REF NAME="fig:rogers"></REF>.<a class="superscript" id="footnote-link-2" href="33.html#footnote-2">[2]</a>

        <SPLIT>
          
            
            <div class="snippet" id="javascript_33_1_div"></div>
<div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('rogers(full_frame);','javascript_33_1','svg()', event,1.0);window.eval('var rogers=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));');">rogers(full_frame);</pre>
<a href="http://source-ide-new.surge.sh/?snippet=rogers(full_frame);&amp;hidden=var%20rogers=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>

          Our Javascript environment provides a function
          <kbd>make_painter_from_url</kbd>, which generates
          a painter for the picture that can be obtained using a given URL
          (Uniform Resource Locator).

            <div class="snippet" id="javascript_33_2_div"></div>
<div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('var bird = make_painter_from_url(\n           &quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/bird.gif&quot;);\nbird(full_frame);','javascript_33_2','svg()', event,1.0);window.eval('function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));');">var bird = make_painter_from_url(
           "http://www.comp.nus.edu.sg/~henz/sicp/img_original/bird.gif");
bird(full_frame);</pre>
<a href="http://source-ide-new.surge.sh/?snippet=var%20bird%20=%20make_painter_from_url(%0A%20%20%20%20%20%20%20%20%20%20%20%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/bird.gif%22);%0Abird(full_frame);&amp;hidden=function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>

          
        </SPLIT>

        <FIGURE>
          <IMAGE src="img_original/ch2-Z-G-30.gif"></IMAGE>
             
          <IMAGE src="img_original/ch2-Z-G-31.gif"></IMAGE>

          <IMAGE src="img_original/ch2-Z-G-32.gif"></IMAGE>
             
          <IMAGE src="img_original/ch2-Z-G-33.gif"></IMAGE>

          
          <div class="chapter-text-CAPTION">Images of William Barton Rogers, founder and first
          president of MIT, painted with respect to the same four frames as in
          Figure <REF NAME="fig:wave"></REF> (original image reprinted with the permission
          of the MIT Museum).
          </div>
        </FIGURE>
      </p>

      <p>
        The four images in Figure <REF NAME="fig:rogers"></REF>
        are drawn with respect to the same four frames
        as the <kbd>wave</kbd> images in Figure <REF NAME="fig:wave"></REF>.
      </p>

      <p>
        
        To combine images,
        we use various operations that construct new painters
        from given painters.
        For example, the
        
        <kbd>beside</kbd> operation takes two painters and produces a new,
        compound painter that draws the first painter's image in the left half
        of the frame and the second painter's image in the right half of the frame.
        Similarly,
        
        <kbd>below</kbd> takes two painters and produces a compound
        painter that draws the first painter's image below the second
        painter's image.
        Some operations transform a single painter to produce
        a new painter.  For example,
        
        <kbd>flip_vert</kbd> takes a painter and
        produces a painter that draws its image upside-down, and
        
        <kbd>flip_horiz</kbd> produces a painter that draws the original
        painter's image left-to-right reversed.
      </p>

      <p>
        Figure <REF NAME="fig:build-up-wave"></REF> shows the drawing of a painter called
        <kbd>wave4</kbd> that is built up in two stages starting from <kbd>wave</kbd>:

        <FIGURE>
        <IMAGE src="img_original/ch2-Z-G-34.gif"></IMAGE>
        <div class="chapter-text-CAPTION">Creating a complex figure,
        starting from the <kbd>wave</kbd> painter of Figure <REF NAME="fig:wave"></REF>.
        </div>
        
        </FIGURE>

        <div class="snippet" id="javascript_33_3_div"></div><div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('var wave2 = beside(wave,flip_vert(wave));','javascript_33_3','svg()', event,1.0);window.eval('var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function flip_vert(painter){return transform_painter(painter,make_vect(0,1),make_vect(1,1),make_vect(0,0))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));');">var wave2 = beside(wave,flip_vert(wave));</pre>
<a href="http://source-ide-new.surge.sh/?snippet=var%20wave2%20=%20beside(wave,flip_vert(wave));&amp;hidden=var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20flip_vert(painter)%7Breturn%20transform_painter(painter,make_vect(0,1),make_vect(1,1),make_vect(0,0))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>

        

        <IMAGE src="img_original/ch2-Z-G-35.gif"></IMAGE>
        <div class="snippet" id="javascript_33_4_div"></div><div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('var wave4 = below(wave2,wave2);','javascript_33_4','svg()', event,1.0);window.eval('var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function flip_vert(painter){return transform_painter(painter,make_vect(0,1),make_vect(1,1),make_vect(0,0))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var wave2=beside(wave,flip_vert(wave));function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));');">var wave4 = below(wave2,wave2);</pre>
<a href="http://source-ide-new.surge.sh/?snippet=var%20wave4%20=%20below(wave2,wave2);&amp;hidden=var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20flip_vert(painter)%7Breturn%20transform_painter(painter,make_vect(0,1),make_vect(1,1),make_vect(0,0))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var%20wave2=beside(wave,flip_vert(wave));function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>

        


      </p>

      <p>
        
        In building up a complex image in this manner we are exploiting the
        fact that painters are closed under the language's means of
        combination.  The <kbd>beside</kbd> or <kbd>below</kbd> of two painters is
        itself a painter; therefore, we can use it as an element in making
        more complex painters.  As with building up list structure using <kbd>pair</kbd>, the closure of our data under the means of combination is
        crucial to the ability to create complex structures while using only a
        few operations.
      </p>

      <p>
        Once we can combine painters, we would like to be able to abstract
        typical patterns of combining painters.
        We will implement the painter operations as Scheme
        functions.
        This means that we don't need a special abstraction mechanism
        in the picture language:
        Since the means of combination
        are ordinary Scheme
        functions, we automatically have the capability
        to do anything with painter operations that we can do with
        functions.
        For example, we can abstract the pattern in <kbd>wave4</kbd> as

        <kbd EVAL="no" class="snippet">function flipped_pairs(painter) {
   var painter2 = beside(painter,flip_vert(painter));
   return below(painter2,painter2);
}</kbd>

        and define <kbd>wave4</kbd> as an instance of this pattern:

        <div class="snippet" id="javascript_33_5_div"></div><div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('var wave4 = flipped_pairs(wave);','javascript_33_5','svg()', event,1.0);window.eval('function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function flip_vert(painter){return transform_painter(painter,make_vect(0,1),make_vect(1,1),make_vect(0,0))};function flipped_pairs(painter){var painter2=beside(painter,flip_vert(painter));return below(painter2,painter2)};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);');">var wave4 = flipped_pairs(wave);</pre>
<a href="http://source-ide-new.surge.sh/?snippet=var%20wave4%20=%20flipped_pairs(wave);&amp;hidden=function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20flip_vert(painter)%7Breturn%20transform_painter(painter,make_vect(0,1),make_vect(1,1),make_vect(0,0))%7D;function%20flipped_pairs(painter)%7Bvar%20painter2=beside(painter,flip_vert(painter));return%20below(painter2,painter2)%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>

        

      </p>

      <p>
        We can also define recursive operations.
        Here's one that makes painters split and branch
        towards the right as shown in Figures <REF NAME="fig:split-plans"></REF>
        and  <REF NAME="fig:splits"></REF>:
        <div class="snippet" id="javascript_33_6_div"></div><div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('function right_split(painter,n) {\n   if (n === 0)\n      return painter;\n   else {\n      var smaller = right_split(painter,n - 1);\n      return beside(painter,below(smaller,smaller));\n   }\n}','javascript_33_6','svg()', event,1.0);window.eval('function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));');">function right_split(painter,n) {
   if (n === 0)
      return painter;
   else {
      var smaller = right_split(painter,n - 1);
      return beside(painter,below(smaller,smaller));
   }
}</pre>
<a href="http://source-ide-new.surge.sh/?snippet=function%20right_split(painter,n)%20%7B%0A%20%20%20if%20(n%20===%200)%0A%20%20%20%20%20%20return%20painter;%0A%20%20%20else%20%7B%0A%20%20%20%20%20%20var%20smaller%20=%20right_split(painter,n%20-%201);%0A%20%20%20%20%20%20return%20beside(painter,below(smaller,smaller));%0A%20%20%20%7D%0A%7D&amp;hidden=function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>

        
        
      </p>

      <p>
        <FIGURE>
          <IMAGE src="img_original/ch2-Z-G-36.gif"></IMAGE>
          <P></P>
          <kbd>right_split</kbd> $n$
          <P></P>
          <IMAGE src="img_original/ch2-Z-G-37.gif"></IMAGE>
          <P></P>
          <kbd>corner_split</kbd> $n$
          <div class="chapter-text-CAPTION">Recursive plans for <kbd>right_split</kbd> and <kbd>corner_split</kbd>.</div>
        
        </FIGURE>
      </p>


      <p>
        We can produce balanced patterns by branching upwards
        as well as towards the right (see Exercise <REF NAME="ex:up-split"></REF>
        and Figures <REF NAME="fig:split-plans"></REF> and  <REF NAME="fig:splits"></REF>):

        <div class="snippet" id="javascript_33_7_div"></div><div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('function corner_split(painter,n) {\n   if (n === 0)\n      return painter;\n   else {\n      var up = up_split(painter,n-1);\n      var right = right_split(painter,n-1);\n      var top_left = beside(up,up);\n      var bottom_right = below(right,right);\n      var corner = corner_split(painter,n-1);\n      return beside(below(painter,top_left),\n                    below(bottom_right,corner));\n   }\n}','javascript_33_7','svg()', event,1.0);window.eval('function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function right_split(painter,n){if(n===0){return painter}else{var smaller=right_split(painter,n-1);return beside(painter,below(smaller,smaller))}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function up_split(painter,n){if(n===0){return painter}else{var smaller=up_split(painter,n-1);return below(painter,beside(smaller,smaller))}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);');">function corner_split(painter,n) {
   if (n === 0)
      return painter;
   else {
      var up = up_split(painter,n-1);
      var right = right_split(painter,n-1);
      var top_left = beside(up,up);
      var bottom_right = below(right,right);
      var corner = corner_split(painter,n-1);
      return beside(below(painter,top_left),
                    below(bottom_right,corner));
   }
}</pre>
<a href="http://source-ide-new.surge.sh/?snippet=function%20corner_split(painter,n)%20%7B%0A%20%20%20if%20(n%20===%200)%0A%20%20%20%20%20%20return%20painter;%0A%20%20%20else%20%7B%0A%20%20%20%20%20%20var%20up%20=%20up_split(painter,n-1);%0A%20%20%20%20%20%20var%20right%20=%20right_split(painter,n-1);%0A%20%20%20%20%20%20var%20top_left%20=%20beside(up,up);%0A%20%20%20%20%20%20var%20bottom_right%20=%20below(right,right);%0A%20%20%20%20%20%20var%20corner%20=%20corner_split(painter,n-1);%0A%20%20%20%20%20%20return%20beside(below(painter,top_left),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20below(bottom_right,corner));%0A%20%20%20%7D%0A%7D&amp;hidden=function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function%20right_split(painter,n)%7Bif(n===0)%7Breturn%20painter%7Delse%7Bvar%20smaller=right_split(painter,n-1);return%20beside(painter,below(smaller,smaller))%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function%20up_split(painter,n)%7Bif(n===0)%7Breturn%20painter%7Delse%7Bvar%20smaller=up_split(painter,n-1);return%20below(painter,beside(smaller,smaller))%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>

        

        
      </p>

      <p>
        <FIGURE>
          <IMAGE src="img_original/ch2-Z-G-38.gif"></IMAGE>
          <div class="snippet" id="javascript_33_8_div"></div>
<div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('right_split(wave,4)','javascript_33_8','svg()', event,1.0);window.eval('var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function right_split(painter,n){if(n===0){return painter}else{var smaller=right_split(painter,n-1);return beside(painter,below(smaller,smaller))}};var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));');">right_split(wave,4)</pre>
<a href="http://source-ide-new.surge.sh/?snippet=right_split(wave,4)&amp;hidden=var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function%20right_split(painter,n)%7Bif(n===0)%7Breturn%20painter%7Delse%7Bvar%20smaller=right_split(painter,n-1);return%20beside(painter,below(smaller,smaller))%7D%7D;var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>
          <P></P>
          <IMAGE src="img_original/ch2-Z-G-39.gif"></IMAGE>
          <div class="snippet" id="javascript_33_9_div"></div>
<div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('right_split(rogers,4)','javascript_33_9','svg()', event,1.0);window.eval('var rogers=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function right_split(painter,n){if(n===0){return painter}else{var smaller=right_split(painter,n-1);return beside(painter,below(smaller,smaller))}};var rogers=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));');">right_split(rogers,4)</pre>
<a href="http://source-ide-new.surge.sh/?snippet=right_split(rogers,4)&amp;hidden=var%20rogers=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function%20right_split(painter,n)%7Bif(n===0)%7Breturn%20painter%7Delse%7Bvar%20smaller=right_split(painter,n-1);return%20beside(painter,below(smaller,smaller))%7D%7D;var%20rogers=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>
          <P></P>
          <IMAGE src="img_original/ch2-Z-G-40.gif"></IMAGE>
          <div class="snippet" id="javascript_33_10_div"></div>
<div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('corner_split(wave,4)','javascript_33_10','svg()', event,1.0);window.eval('var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function right_split(painter,n){if(n===0){return painter}else{var smaller=right_split(painter,n-1);return beside(painter,below(smaller,smaller))}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function up_split(painter,n){if(n===0){return painter}else{var smaller=up_split(painter,n-1);return below(painter,beside(smaller,smaller))}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);function corner_split(painter,n){if(n===0){return painter}else{var up=up_split(painter,n-1);var right=right_split(painter,n-1);var top_left=beside(up,up);var bottom_right=below(right,right);var corner=corner_split(painter,n-1);return beside(below(painter,top_left),below(bottom_right,corner))}};');">corner_split(wave,4)</pre>
<a href="http://source-ide-new.surge.sh/?snippet=corner_split(wave,4)&amp;hidden=var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function%20right_split(painter,n)%7Bif(n===0)%7Breturn%20painter%7Delse%7Bvar%20smaller=right_split(painter,n-1);return%20beside(painter,below(smaller,smaller))%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function%20up_split(painter,n)%7Bif(n===0)%7Breturn%20painter%7Delse%7Bvar%20smaller=up_split(painter,n-1);return%20below(painter,beside(smaller,smaller))%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);function%20corner_split(painter,n)%7Bif(n===0)%7Breturn%20painter%7Delse%7Bvar%20up=up_split(painter,n-1);var%20right=right_split(painter,n-1);var%20top_left=beside(up,up);var%20bottom_right=below(right,right);var%20corner=corner_split(painter,n-1);return%20beside(below(painter,top_left),below(bottom_right,corner))%7D%7D;" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>
          <P></P>
          <IMAGE src="img_original/ch2-Z-G-41.gif"></IMAGE>
          <div class="snippet" id="javascript_33_11_div"></div>
<div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('corner_split(rogers,4)','javascript_33_11','svg()', event,1.0);window.eval('var rogers=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function right_split(painter,n){if(n===0){return painter}else{var smaller=right_split(painter,n-1);return beside(painter,below(smaller,smaller))}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function up_split(painter,n){if(n===0){return painter}else{var smaller=up_split(painter,n-1);return below(painter,beside(smaller,smaller))}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);function corner_split(painter,n){if(n===0){return painter}else{var up=up_split(painter,n-1);var right=right_split(painter,n-1);var top_left=beside(up,up);var bottom_right=below(right,right);var corner=corner_split(painter,n-1);return beside(below(painter,top_left),below(bottom_right,corner))}};');">corner_split(rogers,4)</pre>
<a href="http://source-ide-new.surge.sh/?snippet=corner_split(rogers,4)&amp;hidden=var%20rogers=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function%20right_split(painter,n)%7Bif(n===0)%7Breturn%20painter%7Delse%7Bvar%20smaller=right_split(painter,n-1);return%20beside(painter,below(smaller,smaller))%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function%20up_split(painter,n)%7Bif(n===0)%7Breturn%20painter%7Delse%7Bvar%20smaller=up_split(painter,n-1);return%20below(painter,beside(smaller,smaller))%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);function%20corner_split(painter,n)%7Bif(n===0)%7Breturn%20painter%7Delse%7Bvar%20up=up_split(painter,n-1);var%20right=right_split(painter,n-1);var%20top_left=beside(up,up);var%20bottom_right=below(right,right);var%20corner=corner_split(painter,n-1);return%20beside(below(painter,top_left),below(bottom_right,corner))%7D%7D;" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>
          <div class="chapter-text-CAPTION">
            The recursive operations <kbd>right_split</kbd> and <kbd>corner_split</kbd> applied to the painters <kbd>wave</kbd> and <kbd>rogers</kbd>.
            Combining four <kbd>corner_split</kbd> figures produces
            symmetric <kbd>square_limit</kbd> designs as shown
        in Figure <REF NAME="fig:sqlimit-designs"></REF>.
          </div>
          
        </FIGURE>
      </p>

      <p>
        By placing four copies of a <kbd>corner_split</kbd>
        appropriately, we obtain a pattern called <kbd>square_limit</kbd>, whose
        application to <kbd>wave</kbd> and <kbd>rogers</kbd> is shown in
        Figure <REF NAME="fig:sqlimit-designs"></REF>:
        <div class="snippet" id="javascript_33_12_div"></div><div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('function square_limit(painter,n) {\n   var quarter = corner_split(painter,n);\n   var half = beside(flip_horiz(quarter),quarter);\n   return below(flip_vert(half),half);\n}','javascript_33_12','svg()', event,1.0);window.eval('function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function right_split(painter,n){if(n===0){return painter}else{var smaller=right_split(painter,n-1);return beside(painter,below(smaller,smaller))}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function up_split(painter,n){if(n===0){return painter}else{var smaller=up_split(painter,n-1);return below(painter,beside(smaller,smaller))}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);function corner_split(painter,n){if(n===0){return painter}else{var up=up_split(painter,n-1);var right=right_split(painter,n-1);var top_left=beside(up,up);var bottom_right=below(right,right);var corner=corner_split(painter,n-1);return beside(below(painter,top_left),below(bottom_right,corner))}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function flip_horiz(painter){return transform_painter(painter,make_vect(1,0),make_vect(0,0),make_vect(1,1))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function flip_vert(painter){return transform_painter(painter,make_vect(0,1),make_vect(1,1),make_vect(0,0))};var rogers=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));');">function square_limit(painter,n) {
   var quarter = corner_split(painter,n);
   var half = beside(flip_horiz(quarter),quarter);
   return below(flip_vert(half),half);
}</pre>
<a href="http://source-ide-new.surge.sh/?snippet=function%20square_limit(painter,n)%20%7B%0A%20%20%20var%20quarter%20=%20corner_split(painter,n);%0A%20%20%20var%20half%20=%20beside(flip_horiz(quarter),quarter);%0A%20%20%20return%20below(flip_vert(half),half);%0A%7D&amp;hidden=function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function%20right_split(painter,n)%7Bif(n===0)%7Breturn%20painter%7Delse%7Bvar%20smaller=right_split(painter,n-1);return%20beside(painter,below(smaller,smaller))%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function%20up_split(painter,n)%7Bif(n===0)%7Breturn%20painter%7Delse%7Bvar%20smaller=up_split(painter,n-1);return%20below(painter,beside(smaller,smaller))%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);function%20corner_split(painter,n)%7Bif(n===0)%7Breturn%20painter%7Delse%7Bvar%20up=up_split(painter,n-1);var%20right=right_split(painter,n-1);var%20top_left=beside(up,up);var%20bottom_right=below(right,right);var%20corner=corner_split(painter,n-1);return%20beside(below(painter,top_left),below(bottom_right,corner))%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20flip_horiz(painter)%7Breturn%20transform_painter(painter,make_vect(1,0),make_vect(0,0),make_vect(1,1))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20flip_vert(painter)%7Breturn%20transform_painter(painter,make_vect(0,1),make_vect(1,1),make_vect(0,0))%7D;var%20rogers=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>

        

      </p>

      <EXERCISE>
        Define the
        function

        
        <kbd>up_split</kbd> used by <kbd>corner_split</kbd>.
        It is similar to <kbd>right_split</kbd>, except that it switches the
        roles of <kbd>below</kbd> and <kbd>beside</kbd>.
        

        

        


      </EXERCISE>

      <h2>
        Higher-order operations
      </h2>

      

      <p>
        In addition to abstracting patterns of combining painters, we can work
        at a higher level, abstracting patterns of combining painter operations.
        That is, we can view the painter operations as elements to manipulate
        and can write means of combination for these elementsfunctions
        that
        take painter operations as arguments and create new painter operations.
      </p>

      <p>
        For example, <kbd>flipped_pairs</kbd> and <kbd>square_limit</kbd> each
        arrange four copies of a painter's image in a square pattern; they differ
        only in how they orient the copies.
        One way to abstract this pattern of painter combination is with
        the following
        function, which takes four one-argument painter operations
        and produces a painter operation that transforms a given
        painter with those four operations and arranges the results in a square.
        The functions <kbd>tl</kbd>, <kbd>tr</kbd>, <kbd>bl</kbd>, and <kbd>br</kbd> are the
        transformations to apply to the top left copy, the top right copy,
        the bottom left copy, and the bottom right copy, respectively.

        <div class="snippet" id="javascript_33_13_div"></div><div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('function square_of_four(tl,tr,bl,br) {\n   return function(painter) {\n             var top = beside(tl(painter),tr(painter));\n             var bottom = beside(bl(painter),br(painter));\n             return below(bottom,top);\n          }\n}','javascript_33_13','svg()', event,1.0);window.eval('function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var rogers=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif&quot;);');">function square_of_four(tl,tr,bl,br) {
   return function(painter) {
             var top = beside(tl(painter),tr(painter));
             var bottom = beside(bl(painter),br(painter));
             return below(bottom,top);
          }
}</pre>
<a href="http://source-ide-new.surge.sh/?snippet=function%20square_of_four(tl,tr,bl,br)%20%7B%0A%20%20%20return%20function(painter)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20var%20top%20=%20beside(tl(painter),tr(painter));%0A%20%20%20%20%20%20%20%20%20%20%20%20%20var%20bottom%20=%20beside(bl(painter),br(painter));%0A%20%20%20%20%20%20%20%20%20%20%20%20%20return%20below(bottom,top);%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%7D&amp;hidden=function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var%20rogers=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif%22);" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>

        

        Then <kbd>flipped_pairs</kbd> can be defined in terms
        of <kbd>square_of_four</kbd> as follows:<a class="superscript" id="footnote-link-3" href="33.html#footnote-3">[3]</a>

        <div class="snippet" id="javascript_33_14_div"></div><div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('function flipped_pairs(painter) {\n   var combine4 = square_of_four(identity,flip_vert,\n                                 identity,flip_vert);\n   return combine4(painter);\n}','javascript_33_14','svg()', event,1.0);window.eval('function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var rogers=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif&quot;);function square_of_four(tl,tr,bl,br){return function(painter){var top=beside(tl(painter),tr(painter));var bottom=beside(bl(painter),br(painter));return below(bottom,top)}};function identity(x){return x};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function flip_vert(painter){return transform_painter(painter,make_vect(0,1),make_vect(1,1),make_vect(0,0))};var rogers=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));');">function flipped_pairs(painter) {
   var combine4 = square_of_four(identity,flip_vert,
                                 identity,flip_vert);
   return combine4(painter);
}</pre>
<a href="http://source-ide-new.surge.sh/?snippet=function%20flipped_pairs(painter)%20%7B%0A%20%20%20var%20combine4%20=%20square_of_four(identity,flip_vert,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20identity,flip_vert);%0A%20%20%20return%20combine4(painter);%0A%7D&amp;hidden=function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var%20rogers=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif%22);function%20square_of_four(tl,tr,bl,br)%7Breturn%20function(painter)%7Bvar%20top=beside(tl(painter),tr(painter));var%20bottom=beside(bl(painter),br(painter));return%20below(bottom,top)%7D%7D;function%20identity(x)%7Breturn%20x%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20flip_vert(painter)%7Breturn%20transform_painter(painter,make_vect(0,1),make_vect(1,1),make_vect(0,0))%7D;var%20rogers=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>

        

        and <kbd>square_limit</kbd> can be expressed as<a class="superscript" id="footnote-link-4" href="33.html#footnote-4">[4]</a>

        <div class="snippet" id="javascript_33_15_div"></div><div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('function square_limit(painter,n) {\n   var combine4 = square_of_four(flip_horiz,identity,\n                                 rotate180,flip_vert);\n   return combine4(corner_split(painter,n));\n}','javascript_33_15','svg()', event,1.0);window.eval('function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var rogers=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif&quot;);function square_of_four(tl,tr,bl,br){return function(painter){var top=beside(tl(painter),tr(painter));var bottom=beside(bl(painter),br(painter));return below(bottom,top)}};function identity(x){return x};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function flip_vert(painter){return transform_painter(painter,make_vect(0,1),make_vect(1,1),make_vect(0,0))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function flip_horiz(painter){return transform_painter(painter,make_vect(1,0),make_vect(0,0),make_vect(1,1))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function rotate180(painter){return transform_painter(painter,make_vect(1,1),make_vect(0,1),make_vect(1,0))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function right_split(painter,n){if(n===0){return painter}else{var smaller=right_split(painter,n-1);return beside(painter,below(smaller,smaller))}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function up_split(painter,n){if(n===0){return painter}else{var smaller=up_split(painter,n-1);return below(painter,beside(smaller,smaller))}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var wave=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png&quot;);function corner_split(painter,n){if(n===0){return painter}else{var up=up_split(painter,n-1);var right=right_split(painter,n-1);var top_left=beside(up,up);var bottom_right=below(right,right);var corner=corner_split(painter,n-1);return beside(below(painter,top_left),below(bottom_right,corner))}};var rogers=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));');">function square_limit(painter,n) {
   var combine4 = square_of_four(flip_horiz,identity,
                                 rotate180,flip_vert);
   return combine4(corner_split(painter,n));
}</pre>
<a href="http://source-ide-new.surge.sh/?snippet=function%20square_limit(painter,n)%20%7B%0A%20%20%20var%20combine4%20=%20square_of_four(flip_horiz,identity,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20rotate180,flip_vert);%0A%20%20%20return%20combine4(corner_split(painter,n));%0A%7D&amp;hidden=function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var%20rogers=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif%22);function%20square_of_four(tl,tr,bl,br)%7Breturn%20function(painter)%7Bvar%20top=beside(tl(painter),tr(painter));var%20bottom=beside(bl(painter),br(painter));return%20below(bottom,top)%7D%7D;function%20identity(x)%7Breturn%20x%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20flip_vert(painter)%7Breturn%20transform_painter(painter,make_vect(0,1),make_vect(1,1),make_vect(0,0))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20flip_horiz(painter)%7Breturn%20transform_painter(painter,make_vect(1,0),make_vect(0,0),make_vect(1,1))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20rotate180(painter)%7Breturn%20transform_painter(painter,make_vect(1,1),make_vect(0,1),make_vect(1,0))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function%20right_split(painter,n)%7Bif(n===0)%7Breturn%20painter%7Delse%7Bvar%20smaller=right_split(painter,n-1);return%20beside(painter,below(smaller,smaller))%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));function%20up_split(painter,n)%7Bif(n===0)%7Breturn%20painter%7Delse%7Bvar%20smaller=up_split(painter,n-1);return%20below(painter,beside(smaller,smaller))%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var%20wave=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/my_wave.png%22);function%20corner_split(painter,n)%7Bif(n===0)%7Breturn%20painter%7Delse%7Bvar%20up=up_split(painter,n-1);var%20right=right_split(painter,n-1);var%20top_left=beside(up,up);var%20bottom_right=below(right,right);var%20corner=corner_split(painter,n-1);return%20beside(below(painter,top_left),below(bottom_right,corner))%7D%7D;var%20rogers=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>

        

      </p>

      <EXERCISE>
        The functions <kbd>right_split</kbd> and <kbd>up_split</kbd> can be expressed as
        instances of a general splitting operation.
        Define a
        function

        
        <kbd>split</kbd> with the property that evaluating
        <kbd EVAL="no" class="snippet">var right_split = split(beside,below);
var up_split = split(below,beside);</kbd>

        produces
        functions
        <kbd>right_split</kbd> and <kbd>up_split</kbd> with the same
        behaviors as the ones already defined.
        
    
      </EXERCISE>

      <h2>
        Frames
      </h2>

      
      <p>
        Before we can show how to implement painters and their
        means of combination, we must first consider
        
        frames.  A frame can be described by three vectorsan origin vector
        and two edge vectors.  The origin vector specifies the offset of the
        frame's origin from some absolute origin in the plane, and the edge
        vectors specify the offsets of the frame's corners from its origin.
        If the edges are perpendicular, the frame will be rectangular.
        Otherwise the frame will be a more general parallelogram.
      </p>

      <p>
        Figure <REF NAME="fig:frame"></REF> shows a frame and its associated vectors.  In
        accordance with data abstraction, we need not be
        specific yet about how frames are represented, other than to say that
        there is a constructor
        
        <kbd>make_frame</kbd>, which takes three vectors and
        produces a frame, and three corresponding selectors
        
        <kbd>origin_frame</kbd>,
        
        <kbd>edge1_frame</kbd>, and
        
        <kbd>edge2_frame</kbd> (see
        Exercise <REF NAME="ex:implement-frames"></REF>).

        <img src="img_original/ch2-Z-G-42.gif">
      </p>

      <p>
        
        We will use coordinates in the unit square ($0\leq x,y\leq 1$)
        to specify images.
        With each frame, we associate a
        
        <EM>frame coordinate map</EM>, which
        will be used to shift and scale images to fit the frame.  The map
        transforms the unit square into the frame by
        mapping the vector ${\bf v}=(x,y)$ to the vector sum
        
        \[
        \hbox{Origin(Frame)} + x\cdot \hbox{ Edge}_1\hbox{ (Frame)}
        + y\cdot \hbox{ Edge}_2\hbox{ (Frame)}
        \]
        
        For example, $(0,0)$ is mapped to the origin of the frame, $(1,1)$ to
        the vertex diagonally opposite the origin, and $(0.5,0.5)$ to the
        center of the frame.  We can create a frame's coordinate map with the
        following
        function:<a class="superscript" id="footnote-link-5" href="33.html#footnote-5">[5]</a>

          

          

        <div class="snippet" id="javascript_33_16_div"></div><div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('function frame_coord_map(frame) {\n   return function(v) {\n             return add_vect(origin_frame(frame),\n                             add_vect(scale_vect(xcor_vect(v),\n                                                 edge1_frame(frame)),\n                                      scale_vect(ycor_vect(v),\n                                                 edge2_frame(frame))));\n          };\n}','javascript_33_16','svg()', event,1.0);window.eval('function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};');">function frame_coord_map(frame) {
   return function(v) {
             return add_vect(origin_frame(frame),
                             add_vect(scale_vect(xcor_vect(v),
                                                 edge1_frame(frame)),
                                      scale_vect(ycor_vect(v),
                                                 edge2_frame(frame))));
          };
}</pre>
<a href="http://source-ide-new.surge.sh/?snippet=function%20frame_coord_map(frame)%20%7B%0A%20%20%20return%20function(v)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20return%20add_vect(origin_frame(frame),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20add_vect(scale_vect(xcor_vect(v),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20edge1_frame(frame)),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20scale_vect(ycor_vect(v),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20edge2_frame(frame))));%0A%20%20%20%20%20%20%20%20%20%20%7D;%0A%7D&amp;hidden=function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>
      </p>

      <p>
        Observe that applying <kbd>frame_coord_map</kbd> to a frame returns
        a
        function
        that, given a vector, returns a vector.
        If the argument vector is in the unit square, the result vector
        will be in the frame.  For example,
        <kbd EVAL="no" class="snippet">frame_coord_map(a_frame)(make_vect(0,0))</kbd>
        returns the same vector as
        <kbd EVAL="no" class="snippet">origin_frame(a_frame)</kbd>
      </p>

      <EXERCISE>
        
        
        A two-dimensional vector $v$ running from the origin to a point
        can be represented as a pair
        consisting of an $x$-coordinate and a $y$-coordinate.  Implement a data
        abstraction for vectors by giving a constructor
        
        <kbd>make_vect</kbd> and
        corresponding selectors
        
        <kbd>xcor_vect</kbd> and
        
        <kbd>ycor_vect</kbd>.  In
        terms of your selectors and constructor, implement
        functions

        
        <kbd>add_vect</kbd>,
        
        <kbd>sub_vect</kbd>, and
        
        <kbd>scale_vect</kbd> that perform
        the operations vector addition, vector subtraction, and multiplying a
        vector by a scalar:
        
        \begin{eqnarray*}
        (x_1,y_1)+(x_2,y_2) &amp;=&amp;(x_1+x_2,y_1+y_2)\\
        (x_1,y_1)-(x_2,y_2)&amp;=&amp; (x_1-x_2,y_1-y_2)\\
        s\cdot(x,y)&amp;=&amp;(sx,sy)
        \end{eqnarray*}
        
      </EXERCISE>

      <EXERCISE>
        Here are two possible constructors for frames:
        <kbd EVAL="no" class="snippet">function make_frame(origin,edge1,edge2) {
   return list(origin,edge1,edge2);
}

function make_frame(origin,edge1,edge2) {
   return pair(origin,pair(edge1,edge2));
}</kbd>

        For each constructor supply the appropriate selectors to produce an
        implementation for frames.
        
      </EXERCISE>

      <h2>
        Painters
      </h2>

      
      <p>
        A painter is represented as a
        function
        that, given a frame
        as argument, draws a particular image shifted and scaled to fit the frame.
        That is to say, if <kbd>p</kbd> is a painter and <kbd>f</kbd> is a frame, then we
        produce <kbd>p</kbd>'s image in <kbd>f</kbd> by calling <kbd>p</kbd> with <kbd>f</kbd> as
        argument.
      </p>

      <p>
        The details of how primitive painters are implemented depend on the
        particular characteristics of the graphics system and the type of
        image to be drawn.  For instance, suppose we have a
        function

        
        <kbd>draw_line</kbd> that draws a line on the screen between two specified
        points.  Then we can create painters for line drawings, such as the
        <kbd>wave</kbd> painter in Figure <REF NAME="fig:wave"></REF>, from lists of line
        segments as follows:<a class="superscript" id="footnote-link-6" href="33.html#footnote-6">[6]</a>

        

        <div class="snippet" id="javascript_33_17_div"></div><div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('function segments_to_painter(segment_list) {\n   return function(frame) {\n             return for_each(function(segment) {\n                                return draw_line(frame_coord_map(frame)(start_segment(segment)),\n                                                 frame_coord_map(frame)(end_segment(segment)));\n                             },\n                             segment_list);\n          };\n}','javascript_33_17','svg()', event,1.0);window.eval('function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function start_segment(segment){return head(segment)}function end_segment(segment){return tail(segment)};\n// for_each to be defined by the student\n          ');">function segments_to_painter(segment_list) {
   return function(frame) {
             return for_each(function(segment) {
                                return draw_line(frame_coord_map(frame)(start_segment(segment)),
                                                 frame_coord_map(frame)(end_segment(segment)));
                             },
                             segment_list);
          };
}</pre>
<a href="http://source-ide-new.surge.sh/?snippet=function%20segments_to_painter(segment_list)%20%7B%0A%20%20%20return%20function(frame)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20return%20for_each(function(segment)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20draw_line(frame_coord_map(frame)(start_segment(segment)),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20frame_coord_map(frame)(end_segment(segment)));%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20segment_list);%0A%20%20%20%20%20%20%20%20%20%20%7D;%0A%7D&amp;hidden=function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20start_segment(segment)%7Breturn%20head(segment)%7Dfunction%20end_segment(segment)%7Breturn%20tail(segment)%7D;%0A//%20for_each%20to%20be%20defined%20by%20the%20student%0A%20%20%20%20%20%20%20%20%20%20" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>
      </p>

      <p>
        The segments are given using coordinates with respect to the unit
        square.  For each segment in the list, the painter transforms the
        segment endpoints with the frame coordinate map and draws a line
        between the transformed points.
      </p>

      <p>
        Representing painters as
        functions
        erects a powerful abstraction
        barrier in the picture language.  We can create and intermix
        all sorts of primitive painters, based on a variety of graphics
        capabilities. The details of their implementation do not matter.  Any
        function
        can serve as a painter, provided that it takes a frame as
        argument and draws something scaled to fit the
        frame.<a class="superscript" id="footnote-link-7" href="33.html#footnote-7">[7]</a>
      </p>

      <EXERCISE>
        
        A directed line segment in the
        plane can be represented as a pair of vectorsthe
        vector running from the origin to the start-point of the segment, and
        the vector running from the origin to the end-point of the segment.
        Use your vector representation from Exercise <REF NAME="ex:vectors"></REF> to
        define a representation for segments with a constructor
        
        <kbd>make_segment</kbd> and selectors
        
        <kbd>start_segment</kbd> and
        
        <kbd>end_segment</kbd>.
        
    
      </EXERCISE>

      <EXERCISE>
        Use <kbd>segments_to_painter</kbd> to define the following primitive painters:

        <OL>
          <LI>
            The painter that draws the outline of the designated frame.
          </LI>

          <LI>
            The painter that draws an <QUOTE>X</QUOTE> by connecting opposite corners of
            the frame.
          </LI>

          <LI>
            The painter that draws a diamond shape by connecting the midpoints of
            the sides of the frame.
          </LI>

          <LI>
            The <kbd>wave</kbd> painter.
          </LI>
        </OL>
        
      </EXERCISE>

      <h2>
        Transforming and combining painters
      </h2>

      

      <p>
        An operation on painters (such as <kbd>flip_vert</kbd> or <kbd>beside</kbd>)
        works by creating a painter that invokes the original painters
        with respect to frames derived from the argument frame.
        Thus, for example, <kbd>flip_vert</kbd> doesn't have to know how a painter
        works in order to flip itit just has to know how to turn a frame
        upside down:
        The flipped painter just uses the original painter,
        but in the inverted frame.
      </p>

      <p>
        Painter operations are based on the
        function
        <kbd>transform_painter</kbd>, which takes as arguments a painter and
        information on how to transform a frame and
        produces a new painter.  The transformed painter, when called on a frame,
        transforms the frame and
        calls the original painter on the transformed frame.
        The arguments to <kbd>transform_painter</kbd> are points (represented as vectors)
        that specify the corners of the new frame:
        When mapped into
        the frame, the first point specifies the new frame's origin
        and the other two specify the ends of its edge vectors.
        Thus, arguments within the
        unit square specify a frame contained within the original frame.

        <div class="snippet" id="javascript_33_18_div"></div><div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('function transform_painter(painter,origin,corner1,corner2) {\n   return function(frame) {\n             var m = frame_coord_map(frame);\n             var new_origin = m(origin);\n             return painter(make_frame(new_origin,\n                                       sub_vect(m(corner1),new_origin),\n                                       sub_vect(m(corner2),new_origin)));\n          };\n}','javascript_33_18','svg()', event,1.0);window.eval('function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};');">function transform_painter(painter,origin,corner1,corner2) {
   return function(frame) {
             var m = frame_coord_map(frame);
             var new_origin = m(origin);
             return painter(make_frame(new_origin,
                                       sub_vect(m(corner1),new_origin),
                                       sub_vect(m(corner2),new_origin)));
          };
}</pre>
<a href="http://source-ide-new.surge.sh/?snippet=function%20transform_painter(painter,origin,corner1,corner2)%20%7B%0A%20%20%20return%20function(frame)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20var%20m%20=%20frame_coord_map(frame);%0A%20%20%20%20%20%20%20%20%20%20%20%20%20var%20new_origin%20=%20m(origin);%0A%20%20%20%20%20%20%20%20%20%20%20%20%20return%20painter(make_frame(new_origin,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sub_vect(m(corner1),new_origin),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sub_vect(m(corner2),new_origin)));%0A%20%20%20%20%20%20%20%20%20%20%7D;%0A%7D&amp;hidden=function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>

        Here's how to flip painter images vertically:
        <div class="snippet" id="javascript_33_19_div"></div><div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('function flip_vert(painter) {\n   return transform_painter(painter,\n                            make_vect(0.0,1.0),  // new origin\n                            make_vect(1.0,1.0),  // new end of edge1\n                            make_vect(0.0,0.0)); // new end of edge2\n}','javascript_33_19','svg()', event,1.0);window.eval('function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};');">function flip_vert(painter) {
   return transform_painter(painter,
                            make_vect(0.0,1.0),  // new origin
                            make_vect(1.0,1.0),  // new end of edge1
                            make_vect(0.0,0.0)); // new end of edge2
}</pre>
<a href="http://source-ide-new.surge.sh/?snippet=function%20flip_vert(painter)%20%7B%0A%20%20%20return%20transform_painter(painter,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20make_vect(0.0,1.0),%20%20//%20new%20origin%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20make_vect(1.0,1.0),%20%20//%20new%20end%20of%20edge1%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20make_vect(0.0,0.0));%20//%20new%20end%20of%20edge2%0A%7D&amp;hidden=function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>
      </p>

      <p>
        Using <kbd>transform_painter</kbd>, we can easily define new transformations.
        For example, we can define a painter that shrinks its image to the
        upper-right quarter of the frame it is given:
        <div class="snippet" id="javascript_33_20_div"></div><div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('function shrink_to_upper_right(painter) {\n   return transform_painter(painter,\n                            make_vect(0.5,0.5),\n                            make_vect(1.0,0.5),\n                            make_vect(0.5,1.0));\n}','javascript_33_20','svg()', event,1.0);window.eval('function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};');">function shrink_to_upper_right(painter) {
   return transform_painter(painter,
                            make_vect(0.5,0.5),
                            make_vect(1.0,0.5),
                            make_vect(0.5,1.0));
}</pre>
<a href="http://source-ide-new.surge.sh/?snippet=function%20shrink_to_upper_right(painter)%20%7B%0A%20%20%20return%20transform_painter(painter,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20make_vect(0.5,0.5),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20make_vect(1.0,0.5),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20make_vect(0.5,1.0));%0A%7D&amp;hidden=function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>
        Other transformations rotate images counterclockwise by 90 degrees<a class="superscript" id="footnote-link-8" href="33.html#footnote-8">[8]</a>

        <div class="snippet" id="javascript_33_21_div"></div><div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('function rotate90(painter) {\n   return transform_painter(painter,\n                            make_vect(1.0,0.0),\n                            make_vect(1.0,1.0),\n                            make_vect(0.0,0.0));\n}','javascript_33_21','svg()', event,1.0);window.eval('function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};');">function rotate90(painter) {
   return transform_painter(painter,
                            make_vect(1.0,0.0),
                            make_vect(1.0,1.0),
                            make_vect(0.0,0.0));
}</pre>
<a href="http://source-ide-new.surge.sh/?snippet=function%20rotate90(painter)%20%7B%0A%20%20%20return%20transform_painter(painter,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20make_vect(1.0,0.0),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20make_vect(1.0,1.0),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20make_vect(0.0,0.0));%0A%7D&amp;hidden=function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>
        or squash images towards the center of the frame:<a class="superscript" id="footnote-link-9" href="33.html#footnote-9">[9]</a>

        <div class="snippet" id="javascript_33_22_div"></div><div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('function squash_inwards(painter) {\n   return transform_painter(painter,\n                            make_vect(0.0,0.0),\n                            make_vect(0.65,0.35),\n                            make_vect(0.35,0.65));\n}','javascript_33_22','svg()', event,1.0);window.eval('function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};');">function squash_inwards(painter) {
   return transform_painter(painter,
                            make_vect(0.0,0.0),
                            make_vect(0.65,0.35),
                            make_vect(0.35,0.65));
}</pre>
<a href="http://source-ide-new.surge.sh/?snippet=function%20squash_inwards(painter)%20%7B%0A%20%20%20return%20transform_painter(painter,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20make_vect(0.0,0.0),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20make_vect(0.65,0.35),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20make_vect(0.35,0.65));%0A%7D&amp;hidden=function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>
      </p>

      <p>
        Frame transformation is also the key to
        defining means of combining two or more painters.
        The <kbd>beside</kbd>
        function,
        for example, takes two painters, transforms them
        to paint in the left and right halves of an argument frame respectively,
        and produces a new, compound painter.
        When the compound painter is given a frame, it
        calls the first transformed painter to paint in the left half of
        the frame and calls the second transformed painter to paint in the
        right half of the frame:
        <div class="snippet" id="javascript_33_23_div"></div><div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('function beside(painter1,painter2) {\n   var split_point = make_vect(0.5,0.0);\n   var paint_left =\n          transform_painter(painter1,\n                            make_vect(0.0,0.0),\n                            split_point,\n                            make_vect(0.0,1.0));\n   var paint_right =\n          transform_painter(painter2,\n                            split_point,\n                            make_vect(1.0,0.0),\n                            make_vect(0.5,1.0));\n   return function(frame) {\n             paint_left(frame);\n             paint_right(frame);\n          };\n}','javascript_33_23','svg()', event,1.0);window.eval('function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};');">function beside(painter1,painter2) {
   var split_point = make_vect(0.5,0.0);
   var paint_left =
          transform_painter(painter1,
                            make_vect(0.0,0.0),
                            split_point,
                            make_vect(0.0,1.0));
   var paint_right =
          transform_painter(painter2,
                            split_point,
                            make_vect(1.0,0.0),
                            make_vect(0.5,1.0));
   return function(frame) {
             paint_left(frame);
             paint_right(frame);
          };
}</pre>
<a href="http://source-ide-new.surge.sh/?snippet=function%20beside(painter1,painter2)%20%7B%0A%20%20%20var%20split_point%20=%20make_vect(0.5,0.0);%0A%20%20%20var%20paint_left%20=%0A%20%20%20%20%20%20%20%20%20%20transform_painter(painter1,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20make_vect(0.0,0.0),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20split_point,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20make_vect(0.0,1.0));%0A%20%20%20var%20paint_right%20=%0A%20%20%20%20%20%20%20%20%20%20transform_painter(painter2,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20split_point,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20make_vect(1.0,0.0),%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20make_vect(0.5,1.0));%0A%20%20%20return%20function(frame)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20paint_left(frame);%0A%20%20%20%20%20%20%20%20%20%20%20%20%20paint_right(frame);%0A%20%20%20%20%20%20%20%20%20%20%7D;%0A%7D&amp;hidden=function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>
      </p>

      <p>
        Observe how the painter data abstraction, and in particular the
        representation of painters as
        functions, makes <kbd>beside</kbd> easy to
        implement.  The <kbd>beside</kbd>
        function
        need not know anything
        about the details of the component painters other than that each
        painter will draw something in its designated frame.
      </p>

      <EXERCISE>
        Define the transformation
        
        <kbd>flip_horiz</kbd>, which flips
        painters horizontally, and transformations that rotate
        painters counterclockwise by 180 degrees and 270 degrees.
        

        

        

      </EXERCISE>

      <EXERCISE>
        Define the
        
        <kbd>below</kbd> operation for painters.  The function <kbd>below</kbd> takes two
        painters as arguments.  The resulting painter, given a frame,
        draws with the first painter in the
        bottom of the frame and with the second painter in the top.  Define <kbd>below</kbd> in two different waysfirst by writing a
        function
        that is
        analogous to the <kbd>beside</kbd>
        function
        given above, and
        again in terms of <kbd>beside</kbd> and suitable
        rotation operations (from Exercise <REF NAME="ex:rotate"></REF>).
        
        
      </EXERCISE>

      <h2>
        Levels of language for robust design
      </h2>

      <p>
      The picture language exercises some of the critical ideas
      we've introduced about abstraction with
      functions
      and data.  The
      fundamental data abstractions, painters, are implemented using
        
          
          
            functional
          
        
      representations, which enables the language to
      handle different basic drawing capabilities in a uniform way.  The
      means of combination satisfy the closure property, which permits us to
      easily build up complex designs.  Finally, all the tools for
      abstracting
      functions
      are available to us for abstracting means of
      combination for painters.
      </p>

      <p>
      We have also obtained a glimpse of another crucial idea about
      languages and program design.  This is the approach of
      
      
      <EM>stratified
        design</EM>, the notion that a complex system should be structured as a
      sequence of levels that are described using a sequence of languages.
      Each level is constructed by combining parts that are regarded as
      primitive at that level, and the parts constructed at each level are
      used as primitives at the next level.  The language used at each level
      of a stratified design has primitives, means of combination, and means
      of abstraction appropriate to that level of detail.
      </p>

      <p>
      Stratified design pervades the engineering of complex systems.  For
      example, in computer engineering, resistors and transistors are
      combined (and described using a language of analog circuits) to
      produce parts such as and-gates and or-gates, which form the
      primitives of a language for digital-circuit design.<a class="superscript" id="footnote-link-10" href="33.html#footnote-10">[10]</a>
      These parts are combined to build
      processors, bus structures, and memory systems, which are in turn
      combined to form computers, using languages appropriate to computer
      architecture.  Computers are combined to form distributed systems,
      using languages appropriate for describing network interconnections,
      and so on.
      </p>

      <p>
      As a tiny example of stratification, our picture language uses
      primitive elements (primitive painters) that are created using a
      language that specifies points and lines to provide the lists of line
      segments for <kbd>segments_to_painter</kbd>, or the
      shading details for a painter like <kbd>rogers</kbd>.  The bulk of our
      description of the picture language focused on combining these
      primitives, using geometric combiners such as <kbd>beside</kbd> and <kbd>below</kbd>.  We also worked at a higher level, regarding <kbd>beside</kbd> and
      <kbd>below</kbd> as primitives to be manipulated in a language whose
      operations, such as <kbd>square_of_four</kbd>, capture common patterns of
      combining geometric combiners.
      </p>

      <p>
      
      Stratified design helps make programs <EM>robust</EM>, that is, it makes
      it likely that small changes in a specification will require
      correspondingly small changes in the program.  For instance, suppose
      we wanted to change the image based on <kbd>wave</kbd> shown in
      Figure <REF NAME="fig:sqlimit-designs"></REF>.  We could work at the lowest level
      to change the detailed appearance of the <kbd>wave</kbd> element; we could
      work at the middle level to change the way <kbd>corner_split</kbd>
      replicates the <kbd>wave</kbd>; we could work at the highest level to
      change how <kbd>square_limit</kbd> arranges the four copies of the corner.
      In general, each level of a stratified design provides a different
      vocabulary for expressing the characteristics of the system, and a
      different kind of ability to change it.
      </p>

      <EXERCISE>
        Make changes to the square limit of <kbd>wave</kbd> shown in
        Figure <REF NAME="fig:sqlimit-designs"></REF> by working at each of the levels
        described above.  In particular:

        <OL>
          <LI>
            Add some segments to the primitive <kbd>wave</kbd> painter
            of Exercise <REF NAME="ex:making-wave"></REF> (to add a smile, for example).
          </LI>
          <LI>
            Change the pattern constructed by <kbd>corner_split</kbd>
            (for example, by using only one copy of the
            <kbd>up_split</kbd> and <kbd>right_split</kbd> images instead of two).
          </LI>
          <LI>
            Modify the version of <kbd>square_limit</kbd> that uses
            <kbd>square_of_four</kbd>
            so as to assemble the corners in a different pattern.  (For example, you
            might make the big Mr. Rogers look outward from each corner of the square.)
          </LI>
        </OL>
      </EXERCISE>
      

    <hr>
<div class="footnote">
<a class="footnote-number" id="footnote-1" href="33.html#footnote-link-1">[1] </a><FOOTNOTE>The picture language is based on the language
          
          Peter Henderson created to construct
          images like
          
          M.C. Escher's <QUOTE>Square Limit</QUOTE> woodcut (see <CITATION>Henderson 1982</CITATION>).
          The woodcut incorporates a
          repeated scaled pattern, similar to the arrangements drawn using
          the <kbd>square_limit</kbd>
          function
          in this section.</FOOTNOTE>
</div>
<div class="footnote">
<a class="footnote-number" id="footnote-2" href="33.html#footnote-link-2">[2] </a><FOOTNOTE>
            
            
            William Barton Rogers (18041882) was the founder and first president
            of MIT.  A geologist and talented teacher, he taught at William and
            Mary College and at the University of Virginia.  In 1859 he moved to
            Boston, where he had more time for research, worked on a plan
            for establishing a <QUOTE>polytechnic institute,</QUOTE> and served as
            Massachusetts's first State Inspector of Gas Meters.
          <P>
            When MIT was established in 1861, Rogers was elected its first
            president.  Rogers espoused an ideal of <QUOTE>useful learning</QUOTE> that was
            different from the university education of the time, with its
            overemphasis on the classics, which, as he wrote, <QUOTE>stand in the way of
              the broader, higher and more practical instruction and discipline of
              the natural and social sciences.</QUOTE>  This education was likewise to be
            different from narrow trade-school education.  In Rogers's words:
            <BLOCKQUOTE>
              The world-enforced distinction between the practical and the
              scientific worker is utterly futile, and the whole experience of
              modern times has demonstrated its utter worthlessness.
            </BLOCKQUOTE>
          </P>
          <P>
            Rogers served as president of MIT until 1870, when he resigned due to
            ill health.  In 1878 the second president of MIT,
            
            John Runkle,
            resigned under the pressure of a financial crisis brought on by the
            Panic of 1873 and strain of fighting off attempts by Harvard to take
            over MIT.  Rogers returned to hold the office of president until
            1881.
          </P>
          <P>
            Rogers collapsed and died while addressing MIT's graduating class at
            the commencement exercises of 1882.  Runkle quoted Rogers's last
            words in a memorial address delivered that same year:
            <BLOCKQUOTE>
                <QUOTE>As I stand here today and see what the Institute is, <ELLIPSIS></ELLIPSIS> I call
                  to mind the beginnings of science.  I remember one hundred and fifty
                  years ago Stephen Hales published a pamphlet on the subject of
                  illuminating gas, in which he stated that his researches had
                  demonstrated that 128 grains of bituminous coal</QUOTE>
              <P>
              
              <QUOTE>Bituminous coal,</QUOTE> these were his last words on earth.  Here he bent
                forward, as if consulting some notes on the table before him, then
                slowly regaining an erect position, threw up his hands, and was
                translated from the scene of his earthly labors and triumphs to <QUOTE>the
                  tomorrow of death,</QUOTE> where the mysteries of life are solved, and the
                disembodied spirit finds unending satisfaction in contemplating the
                new and still unfathomable mysteries of the infinite future.
              </P>
            </BLOCKQUOTE>
          </P>
          <P>
            In the words of  Francis A. Walker
            
            (MIT's third president):
            <BLOCKQUOTE>
              All his life he had borne himself most faithfully and heroically, and
              he died as so good a knight would surely have wished, in harness, at
              his post, and in the very part and act of public duty.
            </BLOCKQUOTE>
          </P>
        </FOOTNOTE>
</div>
<div class="footnote">
<a class="footnote-number" id="footnote-3" href="33.html#footnote-link-3">[3] </a><FOOTNOTE>Equivalently, we could
          write
          <div class="snippet" id="javascript_33_24_div"></div>
<div class="pre-prettyprint">
<pre class="prettyprint" title="Evaluate Javascript expression" onclick="new window.JavascriptConsole('var flipped_pairs =\n    square_of_four(identity,flip_vert,identity,flip_vert);','javascript_33_24','svg()', event,1.0);window.eval('function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function beside(painter1,painter2){var split_point=make_vect(0.5,0);var paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return function(frame){paint_left(frame);paint_right(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function below(painter1,painter2){var split_point=make_vect(0,0.5);var paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return function(frame){paint_upper(frame);paint_lower(frame)}};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var rogers=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif&quot;);function square_of_four(tl,tr,bl,br){return function(painter){var top=beside(tl(painter),tr(painter));var bottom=beside(bl(painter),br(painter));return below(bottom,top)}};function identity(x){return x};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function frame_coord_map(frame){return function(v){return add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))}};function transform_painter(painter,origin,corner1,corner2){return function(frame){var m=frame_coord_map(frame);var new_origin=m(origin);return painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))}};function flip_vert(painter){return transform_painter(painter,make_vect(0,1),make_vect(1,1),make_vect(0,0))};var rogers=make_painter_from_url(&quot;http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif&quot;);function list_ref(items,n){if(n===0){return head(items)}else{return list_ref(tail(items),n-1)}};function make_frame(origin,edge1,edge2){return list(origin,edge1,edge2)}function origin_frame(frame){return list_ref(frame,0)}function edge1_frame(frame){return list_ref(frame,1)}function edge2_frame(frame){return list_ref(frame,2)};function make_vect(x,y){return pair(x,y)}function xcor_vect(vector){return head(vector)}function ycor_vect(vector){return tail(vector)}function scale_vect(factor,vector){return make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))}function add_vect(vector1,vector2){return make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))}function sub_vect(vector1,vector2){return make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))};var full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));');">var flipped_pairs =
    square_of_four(identity,flip_vert,identity,flip_vert);</pre>
<a href="http://source-ide-new.surge.sh/?snippet=var%20flipped_pairs%20=%0A%20%20%20%20square_of_four(identity,flip_vert,identity,flip_vert);&amp;hidden=function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20beside(painter1,painter2)%7Bvar%20split_point=make_vect(0.5,0);var%20paint_left=transform_painter(painter1,make_vect(0,0),split_point,make_vect(0,1));var%20paint_right=transform_painter(painter2,split_point,make_vect(1,0),make_vect(0.5,1));return%20function(frame)%7Bpaint_left(frame);paint_right(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20below(painter1,painter2)%7Bvar%20split_point=make_vect(0,0.5);var%20paint_upper=transform_painter(painter1,split_point,make_vect(1,0.5),make_vect(0,1));var%20paint_lower=transform_painter(painter2,make_vect(0,0),make_vect(1,0),split_point);return%20function(frame)%7Bpaint_upper(frame);paint_lower(frame)%7D%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));var%20rogers=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif%22);function%20square_of_four(tl,tr,bl,br)%7Breturn%20function(painter)%7Bvar%20top=beside(tl(painter),tr(painter));var%20bottom=beside(bl(painter),br(painter));return%20below(bottom,top)%7D%7D;function%20identity(x)%7Breturn%20x%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20frame_coord_map(frame)%7Breturn%20function(v)%7Breturn%20add_vect(origin_frame(frame),add_vect(scale_vect(xcor_vect(v),edge1_frame(frame)),scale_vect(ycor_vect(v),edge2_frame(frame))))%7D%7D;function%20transform_painter(painter,origin,corner1,corner2)%7Breturn%20function(frame)%7Bvar%20m=frame_coord_map(frame);var%20new_origin=m(origin);return%20painter(make_frame(new_origin,sub_vect(m(corner1),new_origin),sub_vect(m(corner2),new_origin)))%7D%7D;function%20flip_vert(painter)%7Breturn%20transform_painter(painter,make_vect(0,1),make_vect(1,1),make_vect(0,0))%7D;var%20rogers=make_painter_from_url(%22http://www.comp.nus.edu.sg/~henz/sicp/img_original/ch2-Z-G-30.gif%22);function%20list_ref(items,n)%7Bif(n===0)%7Breturn%20head(items)%7Delse%7Breturn%20list_ref(tail(items),n-1)%7D%7D;function%20make_frame(origin,edge1,edge2)%7Breturn%20list(origin,edge1,edge2)%7Dfunction%20origin_frame(frame)%7Breturn%20list_ref(frame,0)%7Dfunction%20edge1_frame(frame)%7Breturn%20list_ref(frame,1)%7Dfunction%20edge2_frame(frame)%7Breturn%20list_ref(frame,2)%7D;function%20make_vect(x,y)%7Breturn%20pair(x,y)%7Dfunction%20xcor_vect(vector)%7Breturn%20head(vector)%7Dfunction%20ycor_vect(vector)%7Breturn%20tail(vector)%7Dfunction%20scale_vect(factor,vector)%7Breturn%20make_vect(factor*xcor_vect(vector),factor*ycor_vect(vector))%7Dfunction%20add_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)+xcor_vect(vector2),ycor_vect(vector1)+ycor_vect(vector2))%7Dfunction%20sub_vect(vector1,vector2)%7Breturn%20make_vect(xcor_vect(vector1)-xcor_vect(vector2),ycor_vect(vector1)-ycor_vect(vector2))%7D;var%20full_frame=make_frame(make_vect(0,0),make_vect(1,0),make_vect(0,1));" class="snippet-ide-link btn btn-primary">[Open in IDE]</a>
</div>
        </FOOTNOTE>
</div>
<div class="footnote">
<a class="footnote-number" id="footnote-4" href="33.html#footnote-link-4">[4] </a><FOOTNOTE>The function <kbd>rotate180</kbd>
          rotates a painter by 180 degrees (see Exercise <REF NAME="ex:rotate"></REF>).
          Instead of <kbd>rotate180</kbd> we could say <kbd>compose(flip_vert,flip_horiz)</kbd>, using
          the <kbd>compose</kbd>
          function
          from Exercise <REF NAME="ex:compose"></REF>.</FOOTNOTE>
</div>
<div class="footnote">
<a class="footnote-number" id="footnote-5" href="33.html#footnote-link-5">[5] </a><FOOTNOTE>The function <kbd>frame_coord_map</kbd> uses
          the vector operations described in Exercise <REF NAME="ex:vectors"></REF> below, which we
          assume have been implemented using some representation for vectors.
          Because of data abstraction, it doesn't matter what this vector
          representation is, so long as the vector operations behave correctly.</FOOTNOTE>
</div>
<div class="footnote">
<a class="footnote-number" id="footnote-6" href="33.html#footnote-link-6">[6] </a><FOOTNOTE>The function <kbd>segments_to_painter</kbd> uses the representation for line
          segments described in Exercise <REF NAME="ex:segments2"></REF> below.
          It also uses the <kbd>for_each</kbd>
          function
          described in Exercise <REF NAME="ex:for-each"></REF>.</FOOTNOTE>
</div>
<div class="footnote">
<a class="footnote-number" id="footnote-7" href="33.html#footnote-link-7">[7] </a><FOOTNOTE>For example, the <kbd>rogers</kbd> painter of
          Figure <REF NAME="fig:rogers"></REF> was constructed from a gray-level image.
          For each point in a given frame,
          the <kbd>rogers</kbd> painter determines the point in the image that is mapped to it
          under the frame coordinate map, and shades it
          accordingly.  By allowing different types of painters, we are capitalizing on the
          abstract data idea discussed in Section <REF NAME="sec:data?"></REF>, where we
          argued that a rational-number representation could be anything at all that
          satisfies an appropriate condition.  Here we're using the fact that a
          painter can be implemented in any way at all, so long as it draws
          something in the designated frame.  Section <REF NAME="sec:data?"></REF> also
          showed how pairs could be implemented as
          functions.  Painters are our
          second example of a
        
          
          
            functional
          
        
          representation for data.</FOOTNOTE>
</div>
<div class="footnote">
<a class="footnote-number" id="footnote-8" href="33.html#footnote-link-8">[8] </a><FOOTNOTE>The function <kbd>rotate90</kbd> is a pure rotation only for square
          frames, because it also stretches and shrinks the image to fit into
          the rotated frame.</FOOTNOTE>
</div>
<div class="footnote">
<a class="footnote-number" id="footnote-9" href="33.html#footnote-link-9">[9] </a><FOOTNOTE>The diamond-shaped images in Figures <REF NAME="fig:wave"></REF>
          and <REF NAME="fig:rogers"></REF> were created with <kbd>squash_inwards</kbd> applied to
          <kbd>wave</kbd> and <kbd>rogers</kbd>.</FOOTNOTE>
</div>
<div class="footnote">
<a class="footnote-number" id="footnote-10" href="33.html#footnote-link-10">[10] </a><FOOTNOTE>Section <REF NAME="sec:circuit-simulator"></REF> describes one such language.</FOOTNOTE>
</div></SUBSECTION></div>
    </div>

    <div class="nav">
    <!--
      <div type="button" class="btn btn-secondary">
        <a href="http://localhost:3000/chapters/32">&lt; Previous</a>
    </div>
    -->
      <div type="button" class="btn btn-secondary">
        <a class="scroll-next" href="34.html">Next &gt;</a>
      </div>


  </div>
  <script>
//<![CDATA[
var chapter_id = 33;
//]]>
</script>
  <div class="next-page"></div>
</div>

     </div><!-- /.container -->

     <!--<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
     -->
   </body>
</html>
